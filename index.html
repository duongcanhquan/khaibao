<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CỔNG ĐĂNG KÝ TRỰC TUYẾN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab); background-size: 400% 400%; animation: gradient 15s ease infinite; padding: 15px; }
        @keyframes gradient { 0% {background-position:0% 50%} 50% {background-position:100% 50%} 100% {background-position:0% 50%} }
        .glass-card { background: rgba(255,255,255,0.95); border-radius: 20px; padding: 30px; max-width: 900px; margin: auto; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .section-title { font-weight: 800; color: #764ba2; text-transform: uppercase; border-left: 4px solid #667eea; padding-left: 10px; margin: 25px 0 15px 0; font-size: 0.9rem; }
        .btn-submit { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 50px; color: white; padding: 15px; width: 100%; font-weight: 800; margin-top: 20px; }
    </style>
</head>
<body>
<div class="glass-card">
    <div class="text-center mb-4">
        <img src="https://github.com/duongcanhquan/image/blob/main/Logo%20Cao%20%C4%91a%CC%86%CC%89ng%20Vie%CC%A3%CC%82t%20My%CC%83%20-%20ba%CC%89n%20chua%CC%82%CC%89n%202025-01.png?raw=true" style="max-width: 180px;">
        <h2 class="fw-800 mt-3">CỔNG ĐĂNG KÝ TRỰC TUYẾN</h2>
        <p class="small fw-bold text-muted">TRƯỜNG CAO ĐẲNG THỰC HÀNH HÀNG ĐẦU TẠI MIỀN BẮC</p>
    </div>

    <form id="regForm">
        <div class="section-title">1. Thông tin cá nhân</div>
        <div class="row g-3">
            <div class="col-md-4"><label class="small fw-bold">Họ và tên *</label><input type="text" name="fullName" class="form-control" required></div>
            <div class="col-md-4 col-6"><label class="small fw-bold">Ngày sinh *</label><input type="date" name="dob" class="form-control" required></div>
            <div class="col-md-4 col-6"><label class="small fw-bold">Giới tính *</label><select name="gender" class="form-select"><option value="Nam">Nam</option><option value="Nữ">Nữ</option></select></div>
            <div class="col-md-4"><label class="small fw-bold">Nơi sinh *</label><input type="text" name="pob" class="form-control" required></div>
            <div class="col-md-4"><label class="small fw-bold">Dân tộc *</label><input type="text" name="ethnicity" class="form-control" required></div>
            <div class="col-md-4"><label class="small fw-bold">Số CCCD *</label><input type="text" name="cccd" class="form-control" required></div>
            <div class="col-md-6"><label class="small fw-bold">SĐT Cá nhân *</label><input type="tel" name="phone" class="form-control" pattern="[0-9]{10}" required></div>
            <div class="col-md-6"><label class="small fw-bold">Email *</label><input type="email" name="email" class="form-control" required></div>
            <div class="col-12"><label class="small fw-bold">Địa chỉ thường trú *</label><input type="text" name="address" class="form-control" required></div>
        </div>

        <div class="section-title">2. Thông tin gia đình</div>
        <div class="row g-3">
            <div class="col-md-6"><label class="small fw-bold">Họ tên Cha</label><input type="text" name="fatherName" class="form-control"></div>
            <div class="col-md-6"><label class="small fw-bold">SĐT Cha</label><input type="tel" name="fatherPhone" class="form-control"></div>
            <div class="col-md-6"><label class="small fw-bold">Họ tên Mẹ</label><input type="text" name="motherName" class="form-control"></div>
            <div class="col-md-6"><label class="small fw-bold">SĐT Mẹ *</label><input type="tel" name="motherPhone" class="form-control" required></div>
        </div>

        <div class="section-title">3. Thông tin học vấn & Nguyện vọng</div>
        <div class="row g-3">
            <div class="col-md-6"><label class="small fw-bold">Trường THPT/THCS *</label><input type="text" name="school" class="form-control" required></div>
            <div class="col-md-6"><label class="small fw-bold">Tỉnh trường học *</label><input type="text" name="schoolProvince" class="form-control" required></div>
            <div class="col-md-6"><label class="small fw-bold">Ngành học đăng ký *</label><select name="major" id="majorSelect" class="form-select" required><option value="">Đang tải...</option></select></div>
            <div class="col-md-6"><label class="small fw-bold">Thầy/Cô tư vấn *</label><select name="counselor" id="counselorSelect" class="form-select" required><option value="">Đang tải...</option></select></div>
            <div class="col-md-6"><label class="small fw-bold">Điểm trung bình *</label>
                <select name="score" class="form-select" required>
                    <option value="8.0-9.0">8.0-9.0</option>
                    <option value="6.5-7.9">6.5-7.9</option>
                    <option value="5.0-6.4">5.0-6.4</option>
                </select>
            </div>
            <div class="col-md-6"><label class="small fw-bold">Hiện đang là *</label>
                <select name="situation" class="form-select">
                    <option value="Học sinh lớp 12">Học sinh lớp 12</option>
                    <option value="Học sinh lớp 9">Học sinh lớp 9</option>
                    <option value="Đã tốt nghiệp">Đã tốt nghiệp</option>
                </select>
            </div>
        </div>

        <button type="submit" class="btn btn-submit shadow-lg">GỬI ĐĂNG KÝ NGAY</button>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbymDk6OAjdBZDXMZyYarQYdgoNyGDDMz5APGWXC4C9t2DDnUhk1FdbhlUgDDTa_kH_3/exec';

    // LOAD DATA TỪ APPS SCRIPT
    window.addEventListener('DOMContentLoaded', () => {
        fetch(SCRIPT_URL + '?action=getData') // QUAN TRỌNG: Thêm action=getData
        .then(res => res.json())
        .then(data => {
            document.getElementById('majorSelect').innerHTML = '<option value="">-- Chọn ngành --</option>' + data.nganh.map(n => `<option value="${n}">${n}</option>`).join('');
            document.getElementById('counselorSelect').innerHTML = '<option value="">-- Chọn Thầy/Cô --</option>' + data.tuvan.map(t => `<option value="${t}">${t}</option>`).join('');
        }).catch(err => alert("Lỗi tải dữ liệu. Hãy kiểm tra URL Apps Script và đảm bảo đã Deploy New Version Anyone."));
    });

    document.getElementById('regForm').onsubmit = async (e) => {
        e.preventDefault();
        const formData = Object.fromEntries(new FormData(e.target));
        Swal.fire({ title: 'Đang xử lý...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
        try {
            const res = await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(formData) });
            const result = await res.json();
            if(result.result === 'success') {
                Swal.fire('Thành công!', 'Mã SV: ' + result.studentId, 'success');
                e.target.reset();
            }
        } catch (e) { Swal.fire('Lỗi', 'Không thể gửi dữ liệu', 'error'); }
    };
</script>
</body>
</html>
